# Random-Inator [MEDIUM]

## crypto

## Author

- Argus817

## Description

Dr. Heinz Doofenshmirtz plans to take over the Tri-State Area. He created this super secret uncrackable encryption program with the help of his robot buttler Norm. Help Perry the Platypus decrypt the message and sabotage his evil plans.

Attachments: [server.py](../attachments/server.py)

## Socat server

`nc <host> 50001` 

## Flag

`KashiCTF{Y0u_brOK3_mY_R4Nd0m_In4t0r_Curse_yOu_Perry_tH3_Pl4TYpus}`

## Writeup

We are given a single file server.py which is the script running on the server.

```
$ nc 172.17.0.3 50001
Doofenshmirtz Evil Incorporated!!!

All right, I don't like to repeat myself here but it just happens
Anyhow, here's the encrypted message: 6be0323ac7b2f98edc19907467950a360f5fb20e6bbec54f67258f2dea1d631c0c2a516414a57f38d68a3a57890531d647c97c9c08260b026c96c339d0254068c75c5c2b82381e855d45b4c59dd20f70df449255f63a230206319885816bb72c
Ohh, How I love EVIL

Plaintext >> ^C
```

At first, there's not much to go on. There appears to be a pseudo random number generator `PRNG()` which is used to generate the `KEY` and `IV` used for encryption of the flag. The `IV` is also given along with the ciphertext as the first 16 bytes of the ciphertext. Next, the server asks for plaintext and returns the corresponding ciphertext. The same `KEY` is used to decrypt every plaintext. Only the `IV` changes, which is generated by the PRNG. 

Origins of the PRNG are unknown. A vulnerability in the PRNG can be explored. After submitting arbitrary plaintext, it is found that the `IV` repeats itself (specifically after 22 turns). Hence the $21^{st}$ `IV` will surely be the `KEY`

```
$ nc 172.17.0.3 50001
Doofenshmirtz Evil Incorporated!!!

All right, I don't like to repeat myself here but it just happens
Anyhow, here's the encrypted message: a221a2e491207cf23f755e9cbc052de84a188372d41bb19fb72ac35a4c9cfaf58749c04329ac474c7beeaf82836c9b3ae7c7e4eca73001202d2565b7709bea9114ca80288087b72310f1159f13e5eaed55d8a3f3b0a045471ae04492116037f6
Ohh, How I love EVIL

Plaintext >> 00
6be0323ac7b2f98edc19907467950a3698f9b6e10bd7117f63a4641d67f7c7f4

Plaintext >> 00
a221a2e491207cf23f755e9cbc052de8d3f8374c9b393e0aed48b42c1b4bc740

Plaintext >> 00
f6a9d2852e5c9c5e249188bd3277686649503b8d89bca66cd45953aebddced23

Plaintext >> 00
5b757cc3fe4d1d51ece7f972421ca89db005bce059213f8ca75844a2729a896f

Plaintext >> 00
da4f91417cc40c722bea594809044f3dba487b310420215284bf21ebfa4775fc

Plaintext >> 00
da4f91417cc40c722bea594809044f3dba487b310420215284bf21ebfa4775fc

Plaintext >> 00
7aba152e75735bc86567d804294acc8240e1000ac5d6b97a5ae7dbc0d48cfa48

Plaintext >> 00
a221a2e491207cf23f755e9cbc052de8d3f8374c9b393e0aed48b42c1b4bc740

Plaintext >> 00
6be0323ac7b2f98edc19907467950a3698f9b6e10bd7117f63a4641d67f7c7f4

Plaintext >> 00
674d8fb80bce301e336476b1dd4ef6957498236c1134216445e6e8a1307c599d

Plaintext >> 00
b375293656a8b9f32b6789eff95003d15ed0795daaad7434a729fb4c09e04f37

Plaintext >> 00
5d03b39ad3d949e73d297734a9f84b721b5166963f3aa1397f7c64e57aeab27f

Plaintext >> 00
a221a2e491207cf23f755e9cbc052de8d3f8374c9b393e0aed48b42c1b4bc740

Plaintext >> 00
b375293656a8b9f32b6789eff95003d15ed0795daaad7434a729fb4c09e04f37

Plaintext >> 00
5b757cc3fe4d1d51ece7f972421ca89db005bce059213f8ca75844a2729a896f

Plaintext >> 00
963483730151eb82840db14f17159c663808768aae0e6d9da083cb94c2a834a2

Plaintext >> 00
963483730151eb82840db14f17159c663808768aae0e6d9da083cb94c2a834a2

Plaintext >> 00
da4f91417cc40c722bea594809044f3dba487b310420215284bf21ebfa4775fc

Plaintext >> 00
f6a9d2852e5c9c5e249188bd3277686649503b8d89bca66cd45953aebddced23

Plaintext >> 00
5d03b39ad3d949e73d297734a9f84b721b5166963f3aa1397f7c64e57aeab27f

Plaintext >> 00
a221a2e491207cf23f755e9cbc052de8d3f8374c9b393e0aed48b42c1b4bc740

Plaintext >> 00
6be0323ac7b2f98edc19907467950a3698f9b6e10bd7117f63a4641d67f7c7f4

Plaintext >> 00
a221a2e491207cf23f755e9cbc052de8d3f8374c9b393e0aed48b42c1b4bc740

Plaintext >> 00
f6a9d2852e5c9c5e249188bd3277686649503b8d89bca66cd45953aebddced23

Plaintext >> ^C
```

Notice how the first 16 bytes , i.e, the `IV` repeats. It is also hinted by `I don't like to repeat myself here but it just happens`. Decryption by textbook AES returns the flag.
